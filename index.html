<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Indiespensables</title>
</head>
<body>
    <div>
        <input id="url_input" type="text" name="url" value="https://soundcloud.com/indiespensables/mixtape-top-2014">
        <button id="generate_btn" type="button">Generate</button>
        <button id="copy_btn" data-clipboard-target="code">Click To Copy</button>
    </div>
    <textarea id="code" name="Generated code" cols="100" rows="15"></textarea>
    <!-- Javascripts -->
    <script src="https://connect.soundcloud.com/sdk.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="ZeroClipboard.min.js"></script>
    <script>
        SC.initialize({
            client_id: '26c48679f3cfd3c12b827bcf82d63df8',
        });
        var code = $('#code')
        var content = ''
        var post1 = '<div class="separator cover_art" style="clear: both; text-align: center;"><a href="'
        var post2 = '" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="'
        var post3 = '" height="400" width="400" /></a></div><div class="separator soundcloud_player" style="clear: both; text-align: center;"><iframe frameborder="no" height="166" scrolling="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/'
        var post4 = '&amp;color=ED1E79&amp;auto_play=false&amp;hide_related=false&amp;show_comments=false&amp;show_user=true&amp;show_reposts=false" width="100%"></iframe></div>'
        var post5 = '<div class="post_text" style="text-align: justify;">Lorem</div>'

        $('#generate_btn').click(function() {
            code.html('generating...')
            var track_url = $('#url_input').val()
            SC.get('/resolve', { url: track_url }, function(track) {
                var img = track.artwork_url
                if (img == null) {
                    img = "PASTE_IMAGE_URL"
                    alert('Image could not be found. Paste your own image url')
                } else img = img.substring(0, img.length-9) + 't500x500.jpg'
                content = post1+img+post2+img+post3+track.id+post4
                code.text(content)
            })
        })

        // Copy To Clipboard code
        var clipboard = new ZeroClipboard($('#copy_btn'), {
            moviePath: "ZeroClipboard.swf",
            debug: false
        } );

        clipboard.on( "load", function(clientTarget)
        {
            $('#flash-loaded').fadeIn();

            clipboard.on( "complete", function(clipboard, args) {
                clipboard.setText( args.text );
                $('#target-to-copy-text').fadeIn();
            } );
        } );

    </script>
</body>
</html>